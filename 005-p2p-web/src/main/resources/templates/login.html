<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="keywords"
          content="动力金融网，动力金融，动力金融财富,金元宝，金元宝，网络理财，个人理财，投资理财，P2P理财，互联网金融，投资理财，债权转让，理财，网络贷款，个人贷款，理财服务，网贷，小额贷款，网络投融资平台, 网络理财,固定收益,100%本息保障"/>
    <meta name="description" content="动力金融网用户注册，专业的互联网金融信息服务平台"/>
    <title>登录动力金融网-动力金融网,专业的互联网金融信息服务平台</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/style.css}"/>
    <script language="javascript" type="text/javascript" th:src="@{/js/jquery-1.7.2.min.js}"></script>
    <script language="javascript" type="text/javascript" th:src="@{/js/jQuery.md5.js}"></script>
    <script language="javascript" type="text/javascript" th:src="@{/js/login.js}"></script>
</head>

<body>
<!--页头start-->
<div id="header">
    <div th:include="commons/header :: html"></div>
</div>
<!--页头end-->

<div class="login-body">
    <div class="mainBox">
        <div class="homeWap">
            <div class="login-cnt clearfix">
                <div class="login-form">
                    <h2>欢迎登录</h2>

                    <div class="login-box clearfix" style="z-index:10;">
                        <label>账号</label>
                        <input id="phone" name="phone" type="text" class="input_text" placeholder="请输入11位手机号码"
                               maxlength="11"/>
                        <span id="phoneOk" class="ok" style="display:none;"></span>
                        <div id="phoneErr" class="form-hint" style="display:none;"></div>
                    </div>

                    <div class="login-box clearfix" style="z-index:8; padding-bottom:0px;">
                        <label>密码</label>
                        <input id="loginPassword" name="loginPassword" type="password" placeholder="请输入登录密码"
                               class="input_text" maxlength="16"/>
                        <span id="loginPasswordOk" class="ok" style="display:none;"></span>
                        <div id="loginPasswordErr" class="form-hint" style="display:none;z-index:90;"></div>
                    </div>


                    <!--                    <div class="login-yzm">-->
                    <!--                        <div id="showCaptcha" class="yzm-box" style="display:block;">-->
                    <!--                            <input id="captcha" type="text" class="yzm" placeholder="点击右侧图片可刷新"/>-->
                    <!--                            <img th:src="@{/jcaptcha/captcha}" id="imgCode"-->
                    <!--                                 style="cursor:pointer;border:0; display:inline;vertical-align:middle;"/>-->
                    <!--                        </div>-->
                    <!--                        <ul>-->
                    <!--                            <li id="showId"-->
                    <!--                                style="color:red;font-size:12px;width:222px;margin-top:10px;margin-bottom:10px;line-height:18px;"></li>-->
                    <!--                        </ul>-->
                    <!--                    </div>-->


                    <div class="bn-login" id="loginId">
                        <button onclick="Login()">登&nbsp;&nbsp;录</button>
                    </div>
                </div>

                <div class="login-right">
                    <div class="login-boy"></div>
                    <div class="top-txt">
                        动力金融网，便捷的投资平台
                        <br/><br/>
                        加入动力金融网<br/>坐享12.7%历史年化收益
                    </div>

                    <div class="currently">
                        平台用户数：<span id="user">--</span>位，累计成交额： <span id="gold">--</span>元
                    </div>

                    <div class="bn-reg" id="quickRegBtn">
                    </div>

                    <ul class="clearfix">
                        <li><i></i>
                            <h3>优选投资计划</h3>
                            <p>
                                历史年化收益<span>12.7%</span><br/> 投资周期<span>1-12月</span>灵活选择
                            </p>
                        </li>
                        <li class="jpsb"><i></i>
                            <h3>优质借款</h3>
                            <p>
                                投资周期短<br/>安全计划
                            </p>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<!--页脚start-->
<div th:include="commons/footer :: html"></div>
<!--页脚end-->
</body>
<script type="application/javascript">

    //错误提示
    function showError(id, msg) {
        $("#" + id + "Ok").hide();
        $("#" + id + "Err").html("<i></i><p>" + msg + "</p>");
        $("#" + id + "Err").show();
        $("#" + id).addClass("input-red");
    }

    //错误隐藏
    function hideError(id) {
        $("#" + id + "Err").hide();
        $("#" + id + "Err").html("");
        $("#" + id).removeClass("input-red");
    }

    //校验手机号函数
    function checkPhone() {
        //获取手机号码
        let phone = $.trim($('#phone').val());
        //判断手机号码是否为空
        if (phone === undefined || phone === '' || phone === null) {
            showError('phone', '手机号不能为空');
            return false;
        }
        //验证手机号码格式是否正确
        if (/^1[1-9]\d{9}$/.test(phone)) {
        } else {
            showError('phone', '手机号格式不正确');
            return false;
        }
        hideError('phone');
        return true;
    }

    //校验密码函数
    function checkLoginPassword() {
        //获取手机号码
        let loginPassword = $.trim($('#loginPassword').val());
        //判断密码是否为空
        if (loginPassword === undefined || loginPassword === '' || loginPassword === null) {
            showError('loginPassword', '密码不能为空');
            return false;
        }
        //判断密码是否在6-20位之间
        if (loginPassword.length >= 6 && loginPassword.length <= 20) {
        } else {
            showError('loginPassword', '请输入6-20位英文和数字混合密码');
            return false;
        }
        //密码字符只可使用数字和大小写英文字母
        if (/^[0-9a-zA-Z]+$/.test(loginPassword)) {
        } else {
            showError('loginPassword', '密码字符只可使用数字和大小写英文字母');
            return false;
        }
        //密码应同时包含英文和数字
        if (/^(([a-zA-Z]+[0-9]+)|([0-9]+[a-zA-Z]+))[a-zA-Z0-9]*/.test(loginPassword)) {
        } else {
            showError('loginPassword', '密码应同时包含英文和数字');
            return false;
        }
        hideError('loginPassword');
        return true;
    }

    //手机号输入框失去焦点时校验手机号
    $('#phone').blur(function () {
        checkPhone();
    });

    //密码输入框失去焦点时校验密码
    $('#loginPassword').blur(function () {
        checkLoginPassword();
    });

    function Login() {
        let cPhone = checkPhone();
        let cPassword = checkLoginPassword()
        if (cPhone && cPassword) {
            $.ajax({
                url: 'login',
                type: 'post',
                data: {
                    phone: $.trim($('#phone').val()),
                    loginPassword: $.md5($.trim($('#loginPassword').val())),
                },
                success: function (data) {
                    if (data.code === 204) {
                        let callbackURL = document.referrer;
                        if (callbackURL === null || callbackURL === '' || callbackURL === undefined){
                            window.location.href = '/index';
                        }else {
                            window.location.href = callbackURL;
                        }
                    } else {
                        alert(data.message);
                    }
                }
            });
        }
    }
</script>
</html>